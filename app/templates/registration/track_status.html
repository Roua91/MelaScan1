<!DOCTYPE html>
<html>
<head>
    <title>Application Status</title>
</head>
<body>
    <header>
        <nav>
            <a href="{{ url_for('home.home') }}">Home</a> |
            <a href="{{ url_for('auth.track_application') }}">Track Application</a>
        </nav>
    </header>

    <h1>Application Status</h1>

    <h2>{{ application.clinic_name }}</h2>
    <p>Status: <strong>{{ status|title }}</strong></p>

    {% if status == 'approved' %}
    <div>
        <h3>Important Security Notice</h3>
        <p>These credentials are temporary and will be invalidated after first use.</p>
    </div>

    <div>
        <a href="{{ url_for('auth.login') }}">Login Now</a>
    </div>

    <h4>Admin Access:</h4>
    <p>Email: {{ application.admin_email }}</p>
    <p>Temporary Password: {{ admin_credential.temp_password if admin_credential.is_valid else 'Already activated' }}</p>

    {% if doctors %}
    <h4>Doctors:</h4>
    <ul>
        {% for doctor in doctors %}
        <li>
            <strong>{{ doctor.name }}</strong><br>
            Email: {{ doctor.email }}<br>
            {% if doctor.password != '[not set]' %}
            Temporary Password: <span>{{ doctor.password }}</span>
            {% else %}
            <span>Password not set</span>
            {% endif %}
        </li>
        {% endfor %}
    </ul>
    {% else %}
    <p>No doctors registered for this clinic.</p>
    {% endif %}

    {% elif status == 'rejected' %}
    <div>
        <h3>Application Rejected</h3>
        {% if rejection_reason %}
        <p><strong>Reason:</strong> {{ rejection_reason }}</p>
        {% endif %}
    </div>

    <div>
        <a href="{{ url_for('registration.clinic_registration') }}">
            Submit New Application
        </a>
        <a href="mailto:support@melascan.com">
            Contact Support
        </a>
    </div>

    {% else %}
    <div>
        <h3>‚è≥ Application Under Review</h3>
        <p>Submitted on <strong>{{ application.submitted_at.strftime('%B %d, %Y') }}</strong></p>
    </div>

    <div>
        <div>
            <span>1</span>
            <span>Submitted</span>
        </div>
        <div>
            <span>2</span>
            <span>Under Review</span>
        </div>
        <div>
            <span>3</span>
            <span>Approval</span>
        </div>
    </div>

    <h4>What to expect next:</h4>
    <ul>
        <li>Typical review time: <strong>1-2 business days</strong></li>
        <li>Check back here for updates</li>
    </ul>

    <div>
        <a href="{{ url_for('auth.track_application') }}">
            Refresh Status
        </a>
        <a href="mailto:support@melascan.com">
            Contact Support
        </a>
    </div>
    {% endif %}

    <footer>
        <p>&copy; MelaScan</p>
    </footer>
</body>
</html>